digraph "Transfer_Arm_Homing_Flow" {
    // Graph settings
    graph [fontname="Arial", ranksep=0.5, nodesep=0.8, splines=true];
    node [fontname="Arial", fontsize=12, style="filled,rounded", shape=box, margin="0.3,0.2"];
    edge [fontname="Arial", fontsize=10, penwidth=2];
    
    // Title
    labelloc="t";
    label="TRANSFER ARM HOMING SEQUENCE";
    fontsize=20;
    fontname="Arial Bold";
    
    // Legend
    subgraph cluster_legend {
        label="Legend";
        style=filled;
        color=lightgrey;
        fontsize=14;
        
        legend_main [label="Main Process", fillcolor=lightyellow];
        legend_check [label="Decision Point", fillcolor=lightcyan, shape=diamond];
        legend_error [label="Error Condition", fillcolor=lightpink];
        
        legend_main -> legend_check [style=invis];
        legend_check -> legend_error [style=invis];
    }

    // Nodes
    start_homing [label="1. Begin Homing Sequence\n• Power on system\n• Initialize motors", fillcolor=lightyellow];
    
    move_x_to_home [label="2. Move X-Axis Toward Home\n• Set slow speed\n• Move in negative direction", fillcolor=lightyellow];
    
    check_x_home [label="3. Check X Home Switch\n• Monitor for active HIGH signal", shape=diamond, fillcolor=lightcyan];
    
    stop_x [label="4. Stop X Motor\n• Halt movement\n• Zero position counter", fillcolor=lightyellow];
    
    move_z_to_home [label="5. Move Z-Axis Toward Home\n• Set slow speed\n• Move in negative direction", fillcolor=lightyellow];
    
    check_z_home [label="6. Check Z Home Switch\n• Monitor for active HIGH signal", shape=diamond, fillcolor=lightcyan];
    
    stop_z [label="7. Stop Z Motor\n• Halt movement\n• Zero position counter", fillcolor=lightyellow];
    
    move_servo_home [label="8. Set Servo to Home Position\n• Move to 90 degrees (neutral)", fillcolor=lightyellow];
    
    check_timeout [label="9. Check for Timeout\n• Verify homing completed\n• within time limit", shape=diamond, fillcolor=lightcyan];
    
    homing_error [label="10. Homing Error\n• Signal failure\n• Require manual reset", fillcolor=lightpink];
    
    homing_complete [label="11. Homing Complete\n• All axes at home position\n• System ready for operation", fillcolor=lightyellow];
    
    // Edges
    start_homing -> move_x_to_home;
    move_x_to_home -> check_x_home;
    
    check_x_home -> check_x_home [label="Not Reached", constraint=false];
    check_x_home -> stop_x [label="Reached (HIGH)"];
    
    stop_x -> move_z_to_home;
    move_z_to_home -> check_z_home;
    
    check_z_home -> check_z_home [label="Not Reached", constraint=false];
    check_z_home -> stop_z [label="Reached (HIGH)"];
    
    stop_z -> move_servo_home;
    move_servo_home -> check_timeout;
    
    check_timeout -> homing_error [label="Timeout"];
    check_timeout -> homing_complete [label="Success"];
} 